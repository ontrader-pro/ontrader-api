"use strict";(()=>{var e={};e.id=847,e.ids=[847],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},614:(e,a,r)=>{r.r(a),r.d(a,{config:()=>m,default:()=>c,routeModule:()=>p});var t={};r.r(t),r.d(t,{default:()=>handler});var l=r(802),s=r(44),i=r(249);let n="https://fapi.binance.com/fapi/v1/klines",o=new Set(["USDT","USDC","BUSD","DAI","TUSD","USDP","GUSD","USDN"]);function calcEMA(e,a){let r=2/(a+1);return e.reduce((e,a,t)=>t?a*r+e*(1-r):a,0)}function calcRSI(e){let a=0,r=0;for(let t=1;t<e.length;t++){let l=e[t]-e[t-1];l>0?a+=l:r-=l}let t=a/(e.length-1),l=r/(e.length-1)||1e-6;return 100-100/(1+t/l)}async function handler(e,a){try{let e=await fetch("https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=100&page=1&sparkline=false");if(!e.ok)throw Error(`CoinGecko ${e.status}`);let t=await e.json(),l=Array.isArray(t)?t:[],s=await fetch("https://fapi.binance.com/fapi/v1/exchangeInfo");if(!s.ok)throw Error(`BinanceInfo ${s.status}`);let i=await s.json(),c=Array.isArray(i.symbols)?i.symbols:[],m=new Set(c.filter(e=>"PERPETUAL"===e.contractType&&e.symbol.endsWith("USDT")).map(e=>e.baseAsset)),p=l.filter(e=>e.symbol&&!o.has(e.symbol.toUpperCase())).map(e=>({symbol:e.symbol.toUpperCase(),binSymbol:e.symbol.toUpperCase()+"USDT",price:e.current_price})).filter(e=>m.has(e.symbol));handler.prevScores=handler.prevScores||{},handler.prevPhases=handler.prevPhases||{},handler.alerts=handler.alerts||[];let h=[];for(let e of p){let a=0,t="",l=handler.prevScores[e.symbol]||0;try{var r;let l=await (await fetch(`${n}?symbol=${e.binSymbol}&interval=1d&limit=10`)).json(),{max:s,min:i}=function(e){for(let a=e.length-1;a>=0;a--){let r=new Date(e[a][0]);if(0===r.getUTCDay())return{max:+e[a][2],min:+e[a][3]}}let a=e[e.length-1];return{max:+a[2],min:+a[3]}}(Array.isArray(l)?l:[]),o=await (await fetch(`${n}?symbol=${e.binSymbol}&interval=15m&limit=28`)).json(),c=(Array.isArray(o)?o:[]).map(e=>+e[4]),m=calcEMA(c,28),p=calcRSI(c),h=await (await fetch(`${n}?symbol=${e.binSymbol}&interval=5m&limit=28`)).json(),d=(Array.isArray(h)?h:[]).map(e=>+e[4]),u=calcEMA(d,28),y=calcRSI(d),b=await (await fetch(`${n}?symbol=${e.binSymbol}&interval=4m&limit=15`)).json(),f=(Array.isArray(b)?b:[]).map(e=>+e[4]),D=calcRSI(f);t=(r=a=function({price:e,maxD:a,minD:r,ema28_15m:t,rsi15m:l,ema28_5m:s,rsi5m:i,rsi4m:n}){let o=1;return e>r&&(o+=3),e>a&&(o+=2),e<r&&(o-=2),l>50&&e>t&&(o+=2),l<50&&e<t&&(o-=2),i>70&&e>s&&(o+=1),i<30&&e<s&&(o-=1),n<15&&(o+=.5),n>85&&(o-=.5),Math.max(1,Math.min(10,o))}({price:e.price,maxD:s,minD:i,ema28_15m:m,rsi15m:p,ema28_5m:u,rsi5m:y,rsi4m:D}))<=3?"\uD83D\uDD34 Oversold":r<4.9?"\uD83D\uDD34 Bearish Incline":r<6?"\uD83D\uDFE0 Accumulation":r<8.1?"\uD83D\uDFE1 Bullish Incline":"\uD83D\uDFE2 Overbought";let S=handler.prevPhases[e.symbol];S&&S!==t&&(handler.alerts.unshift({time:new Date().toLocaleTimeString(),symbol:e.symbol,oldPhase:S,newPhase:t,price:e.price,score:a.toFixed(2)}),handler.alerts=handler.alerts.slice(0,20)),handler.prevScores[e.symbol]=a,handler.prevPhases[e.symbol]=t}catch(e){t="NoTrade"}h.push({symbol:e.symbol,price:e.price.toFixed(6),prevScore:l.toFixed(2),score:a.toFixed(2),phase:t}),await new Promise(e=>setTimeout(e,200))}a.status(200).json({data:h,alerts:handler.alerts})}catch(e){console.error("API error:",e),a.status(500).json({error:e.message})}}let c=(0,i.l)(t,"default"),m=(0,i.l)(t,"config"),p=new l.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/index-data",pathname:"/api/index-data",bundlePath:"",filename:""},userland:t})}};var a=require("../../webpack-api-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),r=a.X(0,[222],()=>__webpack_exec__(614));module.exports=r})();